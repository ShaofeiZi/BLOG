<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在单页应用中，如何监听url的变化 · ShaofeiZi Blog · 做个日常记录</title>
    <meta name="description" content="訾绍飞的博客。万物皆有裂缝处，那是光射进来的地方。">
    <link rel="shortcut icon" href="/BLOG/favicon.ico">
  <link rel="manifest" href="/BLOG/manifest.json">
  <meta name="theme-color" content="#3F51B5">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/BLOG/icons/192.png">
  <link rel="mask-icon" href="/BLOG/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/192.png">
  <meta name="msapplication-TileColor" content="#3F51B5">
    
    <link rel="preload" href="/BLOG/assets/css/styles.0f06c689.css" as="style"><link rel="preload" href="/BLOG/assets/js/app.0f06c689.js" as="script"><link rel="preload" href="/BLOG/assets/js/11.8a622b5e.js" as="script"><link rel="prefetch" href="/BLOG/assets/js/1.63593f8f.js"><link rel="prefetch" href="/BLOG/assets/js/10.fdd39873.js"><link rel="prefetch" href="/BLOG/assets/js/12.e9c56306.js"><link rel="prefetch" href="/BLOG/assets/js/13.20e44605.js"><link rel="prefetch" href="/BLOG/assets/js/14.eb804906.js"><link rel="prefetch" href="/BLOG/assets/js/15.47582e90.js"><link rel="prefetch" href="/BLOG/assets/js/16.0861cf41.js"><link rel="prefetch" href="/BLOG/assets/js/17.417e8e0e.js"><link rel="prefetch" href="/BLOG/assets/js/18.2318cd37.js"><link rel="prefetch" href="/BLOG/assets/js/19.997f9e1c.js"><link rel="prefetch" href="/BLOG/assets/js/2.73ec8147.js"><link rel="prefetch" href="/BLOG/assets/js/20.a8cf0c8f.js"><link rel="prefetch" href="/BLOG/assets/js/21.88823ca0.js"><link rel="prefetch" href="/BLOG/assets/js/22.a2e20a79.js"><link rel="prefetch" href="/BLOG/assets/js/23.e7d1e135.js"><link rel="prefetch" href="/BLOG/assets/js/24.492e8390.js"><link rel="prefetch" href="/BLOG/assets/js/25.b31904c7.js"><link rel="prefetch" href="/BLOG/assets/js/26.36e1cf84.js"><link rel="prefetch" href="/BLOG/assets/js/27.94b05a58.js"><link rel="prefetch" href="/BLOG/assets/js/28.bdcf9b24.js"><link rel="prefetch" href="/BLOG/assets/js/29.e41d34d2.js"><link rel="prefetch" href="/BLOG/assets/js/3.a4d6da98.js"><link rel="prefetch" href="/BLOG/assets/js/30.ba1f5d39.js"><link rel="prefetch" href="/BLOG/assets/js/31.2bd2d3d8.js"><link rel="prefetch" href="/BLOG/assets/js/32.824499f7.js"><link rel="prefetch" href="/BLOG/assets/js/33.58645df0.js"><link rel="prefetch" href="/BLOG/assets/js/34.334e4a83.js"><link rel="prefetch" href="/BLOG/assets/js/35.aa96d72d.js"><link rel="prefetch" href="/BLOG/assets/js/36.40c509d3.js"><link rel="prefetch" href="/BLOG/assets/js/37.829377f5.js"><link rel="prefetch" href="/BLOG/assets/js/38.3b15ddc7.js"><link rel="prefetch" href="/BLOG/assets/js/39.87218167.js"><link rel="prefetch" href="/BLOG/assets/js/4.c66c6308.js"><link rel="prefetch" href="/BLOG/assets/js/40.63562db5.js"><link rel="prefetch" href="/BLOG/assets/js/41.168fcabb.js"><link rel="prefetch" href="/BLOG/assets/js/42.e8f3ecd2.js"><link rel="prefetch" href="/BLOG/assets/js/43.5eb65461.js"><link rel="prefetch" href="/BLOG/assets/js/44.41e08b42.js"><link rel="prefetch" href="/BLOG/assets/js/45.54b7df8d.js"><link rel="prefetch" href="/BLOG/assets/js/46.0a0de71e.js"><link rel="prefetch" href="/BLOG/assets/js/47.bd587f67.js"><link rel="prefetch" href="/BLOG/assets/js/48.f3af8d7e.js"><link rel="prefetch" href="/BLOG/assets/js/49.483980fa.js"><link rel="prefetch" href="/BLOG/assets/js/5.05c034ec.js"><link rel="prefetch" href="/BLOG/assets/js/50.f814132b.js"><link rel="prefetch" href="/BLOG/assets/js/51.477c87bb.js"><link rel="prefetch" href="/BLOG/assets/js/52.55f963c5.js"><link rel="prefetch" href="/BLOG/assets/js/53.9eafd57f.js"><link rel="prefetch" href="/BLOG/assets/js/54.be1ba528.js"><link rel="prefetch" href="/BLOG/assets/js/55.a0ef8049.js"><link rel="prefetch" href="/BLOG/assets/js/56.8e8dca35.js"><link rel="prefetch" href="/BLOG/assets/js/6.f61c2d7b.js"><link rel="prefetch" href="/BLOG/assets/js/7.acadab6a.js"><link rel="prefetch" href="/BLOG/assets/js/8.8d991ea8.js"><link rel="prefetch" href="/BLOG/assets/js/9.efa09c0d.js">
    <link rel="stylesheet" href="/BLOG/assets/css/styles.0f06c689.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-app="true" id="app" class="application theme--light"><div class="application--wrap"><div role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" class="v-progress-linear blog-progress" style="height:3px;display:none;"><div class="v-progress-linear__background accent" style="height:3px;opacity:0.4;width:100%;"></div><div class="v-progress-linear__bar"><!----><div class="v-progress-linear__bar__determinate accent" style="width:0%;"></div></div></div><aside class="v-navigation-drawer v-navigation-drawer--close v-navigation-drawer--fixed v-navigation-drawer--is-mobile theme--light" style="height:100%;margin-top:0px;transform:translateX(-240px);width:240px;"><div><div class="aside-brand-wrap"><div class="aside-brand"><a href="/BLOG/" class="aside-avatar elevation-2 router-link-active"><img src="/BLOG/face.png" alt="avatar"></a><hgroup class="mt-3 variant-hide"><div class="subheading white--text">訾绍飞</div><a href="mailto:zishaofei221@gmail.com" title="zishaofei221@gmail.com" class="aside-mail primary--text text--lighten-5">zishaofei221@gmail.com</a></hgroup></div></div><hr class="v-divider theme--dark"><div role="list" class="v-list nav-list theme--light"><div role="listitem"><a href="/BLOG/" class="v-list__tile v-list__tile--link theme--light"><div class="v-list__tile__avatar"><div class="v-avatar" style="height:40px;width:40px;"><i class="fa fa-home"></i></div></div><div class="v-list__tile__content">首页</div></a></div><div role="listitem"><a href="/BLOG/tags" class="v-list__tile v-list__tile--link theme--light"><div class="v-list__tile__avatar"><div class="v-avatar" style="height:40px;width:40px;"><i class="fa fa-tag"></i></div></div><div class="v-list__tile__content">标签</div></a></div><div role="listitem"><a href="https://github.com/ShaofeiZi" target="_blank" class="v-list__tile v-list__tile--link theme--light"><div class="v-list__tile__avatar"><div class="v-avatar" style="height:40px;width:40px;"><i class="fab fa-github"></i></div></div><div class="v-list__tile__content">Github</div></a></div><div role="listitem"><a href="/BLOG/about" class="v-list__tile v-list__tile--link theme--light"><div class="v-list__tile__avatar"><div class="v-avatar" style="height:40px;width:40px;"><i class="fa fa-user-secret"></i></div></div><div class="v-list__tile__content">About</div></a></div></div></div><div class="v-navigation-drawer__border"></div></aside><nav class="blog-toolbar v-toolbar v-toolbar--fixed theme--dark primary" style="margin-top:0px;padding-right:0px;padding-left:0px;transform:translateY(0px);"><div class="v-toolbar__content" style="height:56px;"><button type="button" class="v-btn v-btn--icon theme--dark"><div class="v-btn__content"><i class="fa fa-bars"></i></div></button><div class="v-toolbar__title">在单页应用中，如何监听url的变化</div><div class="spacer"></div><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><div class="v-menu v-menu--inline" style="display:none;"><div class="v-menu__activator"><button type="button" class="v-btn v-btn--icon theme--dark"><div class="v-btn__content"><i class="fa fa-share-alt"></i></div></button></div><div class="v-menu__content theme--light " style="max-height:auto;min-width:0px;max-width:auto;top:12px;left:0px;transform-origin:top right;z-index:0;display:none;"><div role="list" class="v-list theme--light"><div role="listitem"><a class="v-list__tile v-list__tile--link theme--light"><div class="v-list__tile__avatar"><div class="v-avatar" style="height:40px;width:40px;"><i class="fa fa-lg fa-copy"></i></div></div><div class="v-list__tile__title">复制链接</div></a></div></div><input type="text" tabindex="-1" aria-hidden="true" value="" class="fake-hide"></div></div></div></nav><main class="v-content" style="padding-top:56px;padding-right:0px;padding-bottom:0px;padding-left:0px;"><div class="v-content__wrap"><div class="container blog-container grid-list-xl align-center"><div class="layout row wrap"><div class="flex mb-3 xs12"><article class="v-card v-sheet theme--light elevation-16 post-card"><div class="v-card__title"><div class="flex xs12"><h2 class="display-1 mb-3">在单页应用中，如何监听url的变化</h2><div class="post-meta"><time datetime="2019-01-19T16:15:53.000Z" class="secondary--text post-time">2019年01月20日</time></div></div></div><div class="v-card__text pt-0 pb-0"><div class="flex xs12"><div class="content custom"><p>单页应用的原理从早起的根据url的hash变化，到根据H5的history的变化，实现无刷新条件下的页面重新渲染。那么在单页应用中是如何监听url的变化呢，本文将总结一下，如何在单页页面中优雅的监听url的变化。</p><p>单页应用原理</p><ul><li>监听url中的hash变化</li><li>监听通过history来改变url的事件</li><li>replaceState和pushState行为的监听
</li></ul><h1 id="一、单页应用原理"><a href="#一、单页应用原理" aria-hidden="true" class="header-anchor">#</a> 一、单页应用原理</h1><p>页应用使得页面可以在无刷新的条件下重新渲染，通过hash或者html5 Bom对象中的history可以做到改变url，但是不刷新页面。</p><h2 id="_1-通过hash来实现单页路由"><a href="#_1-通过hash来实现单页路由" aria-hidden="true" class="header-anchor">#</a> (1)通过hash来实现单页路由</h2><p>早期的前端路由是通过hash来实现的：</p><p><code>改变url的hash值是不会刷新页面的。</code></p><p>因此可以通过hash来实现前端路由，从而实现无刷新的效果。hash属性位于location对象中，在当前页面中，可以通过：</p><pre class="language-text"><code>window.location.hash='edit'
</code></pre><p>来实现改变当前url的hash值。执行上述的hash赋值后，页面的url发生改变。</p><pre class="language-text"><code>赋值前：http://localhost:3000
赋值后：http://localhost:3000/#edit
</code></pre><p>在url中多了以#结尾的hash值，但是赋值前后虽然页面的hash值改变导致页面完整的url发生了改变，但是页面是不会刷新的。</p><p>此外，除了可以通过window.location.hash来改变当前页面的hash值外，还可以通过html的a标签来实现：</p><pre class="language-text"><code>&lt;a href=&quot;#edit&quot;&gt;edit&lt;/a&gt;
</code></pre><h2 id="_2-通过history实现前端路由"><a href="#_2-通过history实现前端路由" aria-hidden="true" class="header-anchor">#</a> (2)通过history实现前端路由</h2><p>HTML5的History接口，History对象是一个底层接口，不继承于任何的接口。History接口允许我们操作浏览器会话历史记录。</p><p>History提供了一些属性和方法。</p><blockquote><p>History的属性：</p></blockquote><ul><li>History.length: 返回在会话历史中有多少条记录，包含了当前会话页面。此外如果打开一个新的Tab，那么这个length的值为1</li><li>History.state:
保存了会出发popState事件的方法，所传递过来的属性对象（后面会在pushState和replaceState方法中详细的介绍）</li></ul><blockquote><p>History方法：</p></blockquote><ul><li><p>History.back(): 返回浏览器会话历史中的上一页，跟浏览器的回退按钮功能相同</p></li><li><p>History.forward():指向浏览器会话历史中的下一页，跟浏览器的前进按钮相同</p></li><li><p>History.go(): 可以跳转到浏览器会话历史中的指定的某一个记录页</p></li><li><p>History.pushState():pushState可以将给定的数据压入到浏览器会话历史栈中，该方法接收3个参数，对象，title和一串url。pushState后会改变当前页面url，但是不会伴随着刷新</p></li><li><p>History.replaceState():replaceState将当前的会话页面的url替换成指定的数据，replaceState后也会改变当前页面的url，但是也不会刷新页面。</p></li></ul><p>上面的方法中，pushState和repalce的相同点：</p><p><code>就是都会改变当前页面显示的url，但都不会刷新页面。</code></p><p>不同点：</p><ul><li>pushState是压入浏览器的会话历史栈中，会使得History.length加1，而replaceState是替换当前的这条会话历史，因此不会增加History.length.*</li></ul><h2 id="_3-总结"><a href="#_3-总结" aria-hidden="true" class="header-anchor">#</a> (3)总结</h2><p>通过改变hash值，或者history的repalceState和pushState都可以实现无刷新的改变url。这样还留有一个问题需要解决：</p><h1 id="二、监听url中的hash变化"><a href="#二、监听url中的hash变化" aria-hidden="true" class="header-anchor">#</a> 二、监听url中的hash变化</h1><p>通过hash改变了url，会触发hashchange事件，只要监听hashchange事件，就能捕获到通过hash改变url的行为。</p><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>//或者</p><pre class="language-javascript"><code>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>当hash值改变时，输出一个HashChangeEvent。该HashChangeEvent的具体值为：</p><pre class="language-javascript"><code>
<span class="token punctuation">{</span>
isTrusted<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
oldURL<span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000/&quot;</span><span class="token punctuation">,</span>
newURL<span class="token operator">:</span>   <span class="token string">&quot;http://localhost:3000/#teg&quot;</span><span class="token punctuation">,</span>
type<span class="token operator">:</span> <span class="token string">&quot;hashchange&quot;</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><p>有了监听事件，且改变hash页面不刷新，这样我们就可以在监听事件的回调函数中，执行我们展示和隐藏不同UI显示的功能，从而实现前端路由。</p><h1 id="三、监听通过history来改变url的事件"><a href="#三、监听通过history来改变url的事件" aria-hidden="true" class="header-anchor">#</a> 三、监听通过history来改变url的事件</h1><p>在上一章讲到了通过History改变url有以下几种方法：History.back()、History.forward()、History.go()、History.pushState()和History.replaceState()。</p><p>同时在history中还支持一个事件，该事件为popstate。第一想法就是如果popstate能够监听所有的history方法所导致的url变化，那么就大功告成了。遗憾的是：</p><p>History.back()、History.forward()、History.go()事件是会触发popstate事件的，但是History.pushState()和History.replaceState()不会触发popstate事件。</p><p>如果是History.back(),History.forward()、History.go()那么会触发popstate事件，我们只需要：</p><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>就可以监听到相应的行为，手动调用：</p><pre class="language-javascript"><code>window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>都会触发这个事件，此外，在浏览器中点击后退和前进按钮也会触发popstate事件，这个事件内容为：</p><pre class="language-javascript"><code>PopStateEvent <span class="token punctuation">{</span>isTrusted<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> state<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;popstate&quot;</span><span class="token punctuation">,</span> target<span class="token operator">:</span> Window<span class="token punctuation">,</span> currentTarget<span class="token operator">:</span> Window<span class="token punctuation">,</span> …<span class="token punctuation">}</span>
</code></pre><p>但是，History.pushState()和History.replaceState()不会触发popstate事件，举例来说：</p><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>first<span class="token operator">:</span><span class="token string">'first'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;page 2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/first&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>上述例子中不会有任何的输出，因为并没有监听的popstate事件的发生。</p><p>但是History.go和History.back()等，虽然可以触发popstate事件，但是都会刷新页面，我们在单页应用中使用的是replaceState和pushState，</p><h1 id="四、replacestate和pushstate行为的监听"><a href="#四、replacestate和pushstate行为的监听" aria-hidden="true" class="header-anchor">#</a> 四、replaceState和pushState行为的监听</h1><p>在上面的例子中我们发现History.replaceState和pushState确实不会触发popstate事件，那么如何监听这两个行为呢。可以通过在方法里面主动的去触发popState事件。另一种就是在方法中创建一个新的全局事件。</p><p>具体做法为：</p><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">_wr</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> orig <span class="token operator">=</span> history<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">var</span> rv <span class="token operator">=</span> <span class="token function">orig</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
       e<span class="token punctuation">.</span>arguments <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
       window<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> rv<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 history<span class="token punctuation">.</span>pushState <span class="token operator">=</span> <span class="token function">_wr</span><span class="token punctuation">(</span><span class="token string">'pushState'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 history<span class="token punctuation">.</span>replaceState <span class="token operator">=</span> <span class="token function">_wr</span><span class="token punctuation">(</span><span class="token string">'replaceState'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>这样就创建了2个全新的事件，事件名为pushState和replaceState，我们就可以在全局监听：</p><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'replaceState'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'THEY DID IT AGAIN! replaceState 111111'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'pushState'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'THEY DID IT AGAIN! pushState 2222222'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>这样就可以监听到pushState和replaceState行为。</p></div></div></div><div class="v-card__actions"><div class="flex xs12"><a href="/BLOG/tags/SPA"><span tabindex="0" class="v-chip capitalize chip-tag v-chip--label v-chip--small theme--light"><span class="v-chip__content">SPA</span></span></a><a href="/BLOG/tags/URL"><span tabindex="0" class="v-chip capitalize chip-tag v-chip--label v-chip--small theme--light"><span class="v-chip__content">URL</span></span></a><a href="/BLOG/tags/hash"><span tabindex="0" class="v-chip capitalize chip-tag v-chip--label v-chip--small theme--light"><span class="v-chip__content">hash</span></span></a><a href="/BLOG/tags/history"><span tabindex="0" class="v-chip capitalize chip-tag v-chip--label v-chip--small theme--light"><span class="v-chip__content">history</span></span></a></div></div></article></div><div class="flex text-xs-left xs6"><a href="/BLOG/posts/macSetupGuide.html" class="post-nav v-btn v-btn--flat v-btn--router theme--light"><div class="v-btn__content"><div class="grey--text"><i class="fa mr-1 fa-chevron-left"></i>Prev</div><div class="title mt-1 primary--text hidden-xs-only">前端程序员的 macOS 搭建指南</div></div></a></div><div class="flex text-xs-right xs6"><a href="/BLOG/posts/ESAsynchronousErrorCapture.html" class="post-nav v-btn v-btn--flat v-btn--router theme--light"><div class="v-btn__content"><div class="grey--text">Next
          <i class="fa ml-1 fa-chevron-right"></i></div><div class="title mt-1 primary--text hidden-xs-only">ES6/ES7中promise、generator和async/await中的异常捕获方法</div></div></a></div><div class="flex mt-3 xs12"><div class="v-card v-sheet theme--light"><div class="v-card__title"><span class="headline">Comment</span></div></div></div></div></div><footer class="v-footer blog-footer darken-1 mt-3 theme--dark" style="height:auto;"><div class="primary--text text--lighten-4 text-xs-center py-3 card-cont v-card v-card--flat v-sheet v-sheet--tile theme--dark primary"><div class="v-card__text pb-0">博客内容遵循 <a rel="license noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></div><div class="v-card__text pt-0 mt-1"><span>訾绍飞 © 2015 - 2020</span><span><!---->
        Power by
        <a href="https://vuepress.vuejs.org" target="_blank" rel="noopener noreferrer">VuePress</a> Theme
        <a href="https://github.com/ShaofeiZi/BLOG" target="_blank" rel="noopener noreferrer">indigo</a></span></div></div></footer></div></main><button type="button" class="v-btn v-btn--bottom v-btn--floating v-btn--fixed v-btn--right theme--light accent" style="display:none;"><div class="v-btn__content"><i class="fa fa-lg fa-chevron-up"></i></div></button></div></div></div>
    <script src="/BLOG/assets/js/app.0f06c689.js" defer></script><script src="/BLOG/assets/js/11.8a622b5e.js" defer></script>
  </body>
</html>
